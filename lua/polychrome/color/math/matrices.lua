local matrix = require('polychrome.matrix')

-- https://bottosson.github.io/posts/oklab/#converting-from-xyz-to-oklab
-- https://github.com/w3c/csswg-drafts/issues/6642#issuecomment-1490068959
local M = {}

-- Oklab_to_lRGB_M1
M.Oklab_to_LMS = matrix({
    { 1.0, 0.3963377773761749,   0.21580375730991364 },
    { 1.0, -0.10556134581565857, -0.0638541728258133 },
    { 1.0, -0.08948418498039246, -1.2914855480194092 },
})
-- lRGB_to_Oklab_M2
M.LMS_to_Oklab = matrix({
    { 0.21045426824930336,  0.7936177747759865,  -0.00407204302528986 },
    { 1.977998539071675,    -2.4285922502018127, 0.4505937111301374 },
    { 0.025904030547901084, 0.7827717270900503,  -0.8086757576379514 },
})

-- lRGB_to_Oklab_M1
M.lRGB_to_LMS = matrix({
    { 0.41222147079999993, 0.5363325363,       0.0514459929 },
    { 0.2119034981999999,  0.6806995450999999, 0.1073969566 },
    { 0.08830246189999998, 0.2817188376,       0.6299787005000002 },
})
-- Oklab_to_lRGB_M2
M.LMS_to_lRGB = matrix({
    { 4.076741661347994,     -3.307711590408193,  0.230969928729428 },
    { -1.2684380040921763,   2.6097574006633715,  -0.3413193963102197 },
    { -0.004196086541837188, -0.7034186144594493, 1.7076147009309444 },
})

-- Oklab_to_XYZ_M1
M.XYZ_to_LMS = matrix({
    { 0.819022442647055,   0.3619062604571286, -0.12887378595068213 },
    { 0.0329836558550745,  0.9292868602921457, 0.03614466586101669 },
    { 0.04817719382823899, 0.2642395276821537, 0.6335478283072317 },
})
-- Oklab_to_XYZ_M2
M.LMS_to_XYZ = matrix({
    { 0.21045426824930336,  0.7936177747759865,  -0.00407204302528986 },
    { 1.977998539071675,    -2.4285922502018127, 0.4505937111301374 },
    { 0.025904030547901084, 0.7827717270900503,  -0.8086757576379514 },
})

return M
